Revenue Recognition and Order Status: The orders and order_items tables contain a status column with values such as Processing, Shipped, Complete, Returned, and Cancelled. A naive "Text-to-SQL" conversion for "Total Revenue" effectively translates to SELECT SUM(sale_price) FROM order_items. This is incorrect. It creates a "Ghost Revenue" problem by including cancelled and returned orders. The agent must be explicitly instructed—via the graph's context or prompt injection—to filter for recognized revenue, typically WHERE status NOT IN ('Cancelled', 'Returned') or WHERE status = 'Complete', depending on the business logic definition. This conditional logic is a primary source of error in automated analysis.



Date Handling and Time Zones: Timestamps in BigQuery are stored as UTC. However, analysis often requires local time aggregation (e.g., "sales by hour of day"). The created_at, shipped_at, and delivered_at columns serve different analytical purposes. The created_at timestamp in orders signals the demand generation, while delivered_at signals revenue realization. The agent must discern that NULL values in delivered_at do not indicate missing data but rather that the order is still in transit. This distinction between "missing data" (error) and "sparse data" (state) is subtle but vital for accurate reporting.   